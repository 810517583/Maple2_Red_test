syntax = "proto3";

package maple2.server.world.service;

import "google/protobuf/empty.proto";

// The world service definition.
service World {
  // Checks the health of this service
  rpc Health(google.protobuf.Empty) returns (HealthResponse);

  // Migrate out of a server.
  rpc MigrateOut(MigrateOutRequest) returns (MigrateOutResponse);
  // Migrate into a server.
  rpc MigrateIn(MigrateInRequest) returns (MigrateInResponse);
  // Send a chat message.
  rpc Chat(ChatRequest) returns (ChatResponse);
}

message HealthResponse {}

message MigrateOutRequest {
  enum Server {
    LOGIN = 0;
    GAME = 1;
  }

  int64 account_id = 1;
  int64 character_id = 2;
  string machine_id = 3;
  Server server = 4;
}

message MigrateOutResponse {
  string ip_address = 1;
  int32 port = 2;
  fixed64 token = 3;
}

message MigrateInRequest {
  int64 account_id = 1;
  fixed64 token = 3;
  string machine_id = 4;
}

message MigrateInResponse {
  int64 character_id = 1;
}

message ChatRequest {
  message Whisper {
    string recipient = 1;
  }
  message Party {
    int64 party_id = 1;
  }
  message Guild {
    int64 guild_id = 1;
  }
  message World {
  }
  message Super {
    int32 item_id = 1;
  }
  message Club {
    int64 club_id = 1;
  }
  message Wedding {
    int32 item_id = 1;
  }

  string message = 1;
  oneof chat {
    Whisper whisper = 4;
    Party party = 7;
    Guild guild = 8;
    World world = 11;
    Super super = 16;
    Club club = 20;
    Wedding wedding = 25;
  }
}

message ChatResponse {
}
